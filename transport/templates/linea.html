{% extends "disposicion.html" %}
{% block content %}
<h1><span class="simbolo_linea" style="background-color: #{{ line.color }}">{{ line.nombre }}</span> {{ line.origen }} - {{ line.destino }} <span class="material-symbols-outlined recargar" id="boton-recarga">refresh</span><small style="font-size: 45%; padding-left: 1em;" id="t"></small></h1>
<span id="alerta" style="background-color: red; padding: 8px 75px 8px 25px; display: none">Mensaje</span>
<p id="id-linea" style="display: none">{{ line.id }}</p>
<!--<div class="diagrama-linea"  style="background-color: red">
    <div class="diagrama-dentro">
        <h2>Ida</h2>
        <div style="height: 100%; background-color: orange; height: fit-content; display: flex; flex-direction: row;">
            <div style="background-color: green; height: 100%; margin-top: 100%"><span class="material-symbols-outlined simbolo_bus">directions_bus</span></div>
            <div><ol class="paradas-linea" style="--color-linea: #{{ line.color }}; background-color: pink">
                {% for parada in paradas.paradas.ida %}
                    <li class="parada"><span class="nombre_parada">{{ parada.nombre }}</span><p><a href="{{ url_for('parada', id_parada=parada.id) }}">Enlaces:</a> {% for enlace in parada.lineas %}<span class="simbolo_linea" style="background-color: #{{ enlace.color }}">{{ enlace.nombre }}</span>{% endfor%}</p></li>
                {% endfor %}
            </ol></div>
        </div>
    </div>
    <div class="diagrama-dentro">
        <h2>Vuelta</h2>
        <span class="material-symbols-outlined" style="color: white; background-color: #5e35b1; padding: 2px; border-radius: 4px; position: absolute; margin: 100% 0%">directions_bus</span>
        <ol class="paradas-linea" style="--color-linea: #{{ line.color }};">
            {% for parada in paradas.paradas.vuelta %}
            <li class="parada"><span class="nombre_parada">{{ parada.nombre }}</span><p><a href="{{ url_for('parada', id_parada=parada.id) }}">Enlaces:</a> {% for enlace in parada.lineas %}<span class="simbolo_linea" style="background-color: #{{ enlace.color }}">{{ enlace.nombre }}</span>{% endfor%}</p></li>
            {% endfor %}
        </ol>
    </div>
</div>-->
<div class="diagrama-linea">
    <div class="diagrama-dentro">
        <h2>Ida</h2>
        <div style="display: flex; flex-direction: row;" id="ida">
            <!--<div style="margin-top: 39.4%"><span class="material-symbols-outlined simbolo_bus">directions_bus</span><br><small style="text-align: center; display: block">598</small></div>-->
            <div><ol class="paradas-linea" style="--color-linea: #{{ line.color }}">
                {% for parada in paradas.paradas.ida %}
                    <li class="parada"><span class="nombre_parada">{{ parada.nombre }}</span><p><a href="{{ url_for('parada', id_parada=parada.id) }}">Enlaces:</a> {% for enlace in parada.lineas %}<span class="simbolo_linea" style="background-color: #{{ enlace.color }}">{{ enlace.nombre }}</span>{% endfor%}</p></li>
                {% endfor %}
            </ol></div>
        </div>
    </div>
    <div class="diagrama-dentro">
        <h2>Vuelta</h2>
        <div style="display: flex; flex-direction: row;" id="vuelta">
            <!--<div style="margin-top: 30.4%"><span class="material-symbols-outlined simbolo_bus">directions_bus</span></div>
            <div style="margin-top: 35.4%"><span class="material-symbols-outlined simbolo_bus">directions_bus</span></div>
            <div style="margin-top: 40.4%"><span class="material-symbols-outlined simbolo_bus">directions_bus</span></div>-->
            <!--<div style="margin-top: 100%; background-color: red; height: fit-content"><span class="material-symbols-outlined simbolo_bus">directions_bus</span></div>-->
            <div><ol class="paradas-linea" style="--color-linea: #{{ line.color }}">
                {% for parada in paradas.paradas.vuelta %}
                    <li class="parada"><span class="nombre_parada">{{ parada.nombre }}</span><p><a href="{{ url_for('parada', id_parada=parada.id) }}">Enlaces:</a> {% for enlace in parada.lineas %}<span class="simbolo_linea" style="background-color: #{{ enlace.color }}">{{ enlace.nombre }}</span>{% endfor%}</p></li>
                {% endfor %}
            </ol></div>
        </div>
    </div>
</div>
<!--<script src="/static/scripts/linea.js"></script>--> 

<!--<link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ==" crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js" integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ==" crossorigin=""></script>-->
<!-- leafletjs -->
<!--<div id="map"></div>
<script src="/api/linea/{{ linea }}/buses"></script>
<script>
    var map = L.map('map').setView([43.3445, -8.425], 14);
    /* var map = L.map('map'),
        realtime = L.realtime({
            url: '/api/linea/500/buses',
            crossOrigin: false,
            type: 'json'
        }, {
            interval: 15000
        }).addTo(map);

    realtime.on('update', function() {
        map.fitBounds(realtime.getBounds(), {maxZoom: 13})
    }) */

    var tiles = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a>',
        minZoom: 13
    }).addTo(map);

     function icono(feature, latlng) {
        let iconoBus = L.icon({
            iconUrl: '/static/icono-bus-32.png',

            iconSize: [32, 32],
            iconAnchor: [16, 16],
            popupAnchor: [16, 28],
        })
        return L.marker(latlng, { icon: iconoBus })
    }

    let opts = {
        pointToLayer: icono
    }

    L.geoJson(buses, opts).addTo(map);
</script>-->
<hr>
<h1>Ida</h1>
{% if buses[0] %}
{% for parada in buses[0]['paradas'] %}
    <p>Parada {{ parada.parada }}
    {% for bus in parada.buses %}
        <p>Bus nº: {{ bus.bus }}; Estado: {{ bus.estado }}; Distancia: {{ bus.distancia*100 }}%</p>
        <p>0 Significa que el bus está en la parada, 1 significa que el bus está en movimiento, el porcentaje representa el porcentaje del bus en el recorrido total</p>
    {% endfor %}
    <hr>
{% endfor %}
{% endif %}
<h1>Vuelta</h1>
{% if buses[1] %}
{% for parada in buses[1]['paradas'] %}
    <p>Parada {{ parada.parada }}
    {% for bus in parada.buses %}
        <p>Bus nº: {{ bus.bus }}; Estado: {{ bus.estado }}; Distancia: {{ bus.distancia*100 }}%</p>
        <p>0 Significa que el bus está en la parada, 1 significa que el bus está en movimiento, el porcentaje representa el porcentaje del bus en el recorrido total</p>
    {% endfor %}
    <hr>
{% endfor %}
{% endif %}
{% endblock content %}